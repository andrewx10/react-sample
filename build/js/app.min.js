"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var BillingAmount=function(e){function r(e){var t;_classCallCheck(this,r),(t=_possibleConstructorReturn(this,_getPrototypeOf(r).call(this,e))).state={loading:!0,billFieldLoadingMessage:"Loading...",averageBalance:0};var n=_assertThisInitialized(_assertThisInitialized(t));return $.get("bill.json").then(function(e){n.setState({currentServicePlan:e.currentServicePlan,billFieldLoadingMessage:"<li>                                <label>Current service plan:</label> "+e.currentServicePlan+"                            </li>                            <li>                                <label>Average balance: </label> $"+e.averageBalance+"                            </li>                            <li>                                <label>Fees paid: </label> $"+e.feesPaid+"                            </li>",averageBalance:e.averageBalance,feesPaid:e.feesPaid,loading:!1})}),t}return _inherits(r,e),_createClass(r,[{key:"render",value:function(){return React.createElement("ul",{class:"flex-container",dangerouslySetInnerHTML:{__html:this.state.billFieldLoadingMessage}})}}]),r}(React.Component);function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}ReactDOM.render(React.createElement(BillingAmount),document.querySelector("#average_balance_container"));var BillingAmount2=function(e){function r(e){var t;_classCallCheck(this,r),(t=_possibleConstructorReturn(this,_getPrototypeOf(r).call(this,e))).state={loading:!0,billFieldLoadingMessage:"Loading...",billAmount:100};var n=_assertThisInitialized(_assertThisInitialized(t));return setTimeout(function(){n.setState({billAmount:800,loading:!1}),n.setState({billFieldLoadingMessage:n.state.billAmount})},2200),t}return _inherits(r,e),_createClass(r,[{key:"render",value:function(){var e=this;return React.createElement("span",{onClick:function(){return e.setState({billAmount:300})}},this.state.billFieldLoadingMessage)}}]),r}(React.Component),BillingHeader=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return React.createElement("h3",{},"Current Month Billing Summary")}}]),t}(React.Component);function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}ReactDOM.render(React.createElement("h3",{},"Current Month Billing Summary"),document.querySelector("#bill_header_container"));var BillingWidget=function(e){function n(e){var t;return _classCallCheck(this,n),(t=_possibleConstructorReturn(this,_getPrototypeOf(n).call(this,e))).state={billed:!1},t}return _inherits(n,e),_createClass(n,[{key:"render",value:function(){var e=this;return this.state.billed?"You billed this.":React.createElement("button",{onClick:function(){return e.setState({billed:!0})}},"Bill")}}]),n}(React.Component),billingDomContainer=document.querySelector("#bill_button_container");function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}ReactDOM.render(React.createElement(BillingWidget),billingDomContainer);var FeesPaid=function(e){function r(e){var t;_classCallCheck(this,r),(t=_possibleConstructorReturn(this,_getPrototypeOf(r).call(this,e))).state={loading:!0,billFieldLoadingMessage:"Loading...",feesPaid:0};var n=_assertThisInitialized(_assertThisInitialized(t));return $.get("fees-paid.json").then(function(e){n.setState({feesPaid:e.feesPaid,loading:!1})}),setTimeout(function(){n.setState({billFieldLoadingMessage:n.state.feesPaid})},2500),t}return _inherits(r,e),_createClass(r,[{key:"render",value:function(){var e=this;return React.createElement("span",{onClick:function(){return e.setState({billAmount:300})}},this.state.billFieldLoadingMessage)}}]),r}(React.Component);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF2ZXJhZ2VfYmFsYW5jZS5qcyIsImJpbGxfYW1vdW50XzIuanMiLCJiaWxsaW5nLmpzIiwiZmVlc19wYWlkLmpzIl0sIm5hbWVzIjpbIl90eXBlb2YiLCJvYmoiLCJTeW1ib2wiLCJpdGVyYXRvciIsImNvbnN0cnVjdG9yIiwicHJvdG90eXBlIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIl9kZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJpIiwibGVuZ3RoIiwiZGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5Iiwia2V5IiwiX2NyZWF0ZUNsYXNzIiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iLCJzZWxmIiwiY2FsbCIsIl9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQiLCJfZ2V0UHJvdG90eXBlT2YiLCJvIiwic2V0UHJvdG90eXBlT2YiLCJnZXRQcm90b3R5cGVPZiIsIl9fcHJvdG9fXyIsIl9pbmhlcml0cyIsInN1YkNsYXNzIiwic3VwZXJDbGFzcyIsImNyZWF0ZSIsInZhbHVlIiwiX3NldFByb3RvdHlwZU9mIiwicCIsIlJlZmVyZW5jZUVycm9yIiwiQmlsbGluZ0Ftb3VudCIsIl9SZWFjdCRDb21wb25lbnQiLCJfdGhpcyIsInRoaXMiLCJzdGF0ZSIsImxvYWRpbmciLCJiaWxsRmllbGRMb2FkaW5nTWVzc2FnZSIsImF2ZXJhZ2VCYWxhbmNlIiwidGhhdCIsIiQiLCJnZXQiLCJ0aGVuIiwiZGF0YSIsInNldFN0YXRlIiwiY3VycmVudFNlcnZpY2VQbGFuIiwiZmVlc1BhaWQiLCJSZWFjdCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzcyIsImRhbmdlcm91c2x5U2V0SW5uZXJIVE1MIiwiX19odG1sIiwiQ29tcG9uZW50IiwiUmVhY3RET00iLCJyZW5kZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJCaWxsaW5nQW1vdW50MiIsImJpbGxBbW91bnQiLCJzZXRUaW1lb3V0IiwiX3RoaXMyIiwib25DbGljayIsIkJpbGxpbmdIZWFkZXIiLCJfUmVhY3QkQ29tcG9uZW50MiIsImFwcGx5IiwiYXJndW1lbnRzIiwiQmlsbGluZ1dpZGdldCIsImJpbGxlZCIsImJpbGxpbmdEb21Db250YWluZXIiLCJGZWVzUGFpZCJdLCJtYXBwaW5ncyI6IkFBQUEsYUFFQSxTQUFBQSxRQUFBQyxHQUFBLE9BQUFELFFBQUEsbUJBQUFFLFFBQUEsaUJBQUFBLE9BQUFDLFNBQUEsU0FBQUYsR0FBQSxjQUFBQSxHQUFBLFNBQUFBLEdBQUEsT0FBQUEsR0FBQSxtQkFBQUMsUUFBQUQsRUFBQUcsY0FBQUYsUUFBQUQsSUFBQUMsT0FBQUcsVUFBQSxnQkFBQUosSUFBQUEsR0FFQSxTQUFBSyxnQkFBQUMsRUFBQUMsR0FBQSxLQUFBRCxhQUFBQyxHQUFBLE1BQUEsSUFBQUMsVUFBQSxxQ0FFQSxTQUFBQyxrQkFBQUMsRUFBQUMsR0FBQSxJQUFBLElBQUFDLEVBQUEsRUFBQUEsRUFBQUQsRUFBQUUsT0FBQUQsSUFBQSxDQUFBLElBQUFFLEVBQUFILEVBQUFDLEdBQUFFLEVBQUFDLFdBQUFELEVBQUFDLGFBQUEsRUFBQUQsRUFBQUUsY0FBQSxFQUFBLFVBQUFGLElBQUFBLEVBQUFHLFVBQUEsR0FBQUMsT0FBQUMsZUFBQVQsRUFBQUksRUFBQU0sSUFBQU4sSUFFQSxTQUFBTyxhQUFBZCxFQUFBZSxFQUFBQyxHQUFBLE9BQUFELEdBQUFiLGtCQUFBRixFQUFBSCxVQUFBa0IsR0FBQUMsR0FBQWQsa0JBQUFGLEVBQUFnQixHQUFBaEIsRUFFQSxTQUFBaUIsMkJBQUFDLEVBQUFDLEdBQUEsT0FBQUEsR0FBQSxXQUFBM0IsUUFBQTJCLElBQUEsbUJBQUFBLEVBQUFDLHVCQUFBRixHQUFBQyxFQUVBLFNBQUFFLGdCQUFBQyxHQUFBLE9BQUFELGdCQUFBVixPQUFBWSxlQUFBWixP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dXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSkgeyByZXR1cm4gY2FsbDsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfVxuXG5mdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvblwiKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9XG5cbmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9XG5cbmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gc2VsZjsgfVxuXG52YXIgQmlsbGluZ0Ftb3VudCA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX1JlYWN0JENvbXBvbmVudCkge1xuICBfaW5oZXJpdHMoQmlsbGluZ0Ftb3VudCwgX1JlYWN0JENvbXBvbmVudCk7XG5cbiAgZnVuY3Rpb24gQmlsbGluZ0Ftb3VudChwcm9wcykge1xuICAgIHZhciBfdGhpcztcblxuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCaWxsaW5nQW1vdW50KTtcblxuICAgIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX2dldFByb3RvdHlwZU9mKEJpbGxpbmdBbW91bnQpLmNhbGwodGhpcywgcHJvcHMpKTtcbiAgICBfdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGxvYWRpbmc6IHRydWUsXG4gICAgICBiaWxsRmllbGRMb2FkaW5nTWVzc2FnZTogJ0xvYWRpbmcuLi4nLFxuICAgICAgYXZlcmFnZUJhbGFuY2U6IDBcbiAgICB9O1xuXG4gICAgdmFyIHRoYXQgPSBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpKTtcblxuICAgIGZ1bmN0aW9uIGdldEJpbGxpbmcoKSB7XG4gICAgICAkLmdldCgnYmlsbC5qc29uJykudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB0aGF0LnNldFN0YXRlKHtcbiAgICAgICAgICBjdXJyZW50U2VydmljZVBsYW46IGRhdGEuY3VycmVudFNlcnZpY2VQbGFuLFxuICAgICAgICAgIGJpbGxGaWVsZExvYWRpbmdNZXNzYWdlOiBcIjxsaT5cXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWw+Q3VycmVudCBzZXJ2aWNlIHBsYW46PC9sYWJlbD4gXCIgKyBkYXRhLmN1cnJlbnRTZXJ2aWNlUGxhbiArIFwiXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xpPlxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxpPlxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbD5BdmVyYWdlIGJhbGFuY2U6IDwvbGFiZWw+ICRcIiArIGRhdGEuYXZlcmFnZUJhbGFuY2UgKyBcIlxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9saT5cXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsaT5cXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWw+RmVlcyBwYWlkOiA8L2xhYmVsPiAkXCIgKyBkYXRhLmZlZXNQYWlkICsgXCJcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGk+XCIsXG4gICAgICAgICAgYXZlcmFnZUJhbGFuY2U6IGRhdGEuYXZlcmFnZUJhbGFuY2UsXG4gICAgICAgICAgZmVlc1BhaWQ6IGRhdGEuZmVlc1BhaWQsXG4gICAgICAgICAgbG9hZGluZzogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBnZXRCaWxsaW5nKCk7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKEJpbGxpbmdBbW91bnQsIFt7XG4gICAga2V5OiBcInJlbmRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudCgndWwnLCB7XG4gICAgICAgIGNsYXNzOiBcImZsZXgtY29udGFpbmVyXCIsXG4gICAgICAgIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MOiB7XG4gICAgICAgICAgX19odG1sOiB0aGlzLnN0YXRlLmJpbGxGaWVsZExvYWRpbmdNZXNzYWdlXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBCaWxsaW5nQW1vdW50O1xufShSZWFjdC5Db21wb25lbnQpO1xuXG5SZWFjdERPTS5yZW5kZXIoUmVhY3QuY3JlYXRlRWxlbWVudChCaWxsaW5nQW1vdW50KSwgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2F2ZXJhZ2VfYmFsYW5jZV9jb250YWluZXInKSk7IiwiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBfdHlwZW9mKG9iaikgeyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2Yob2JqKTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikpIHsgcmV0dXJuIGNhbGw7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH1cblxuZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb25cIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfVxuXG5mdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfVxuXG5mdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIHNlbGY7IH1cblxudmFyIEJpbGxpbmdBbW91bnQyID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uIChfUmVhY3QkQ29tcG9uZW50KSB7XG4gIF9pbmhlcml0cyhCaWxsaW5nQW1vdW50MiwgX1JlYWN0JENvbXBvbmVudCk7XG5cbiAgZnVuY3Rpb24gQmlsbGluZ0Ftb3VudDIocHJvcHMpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQmlsbGluZ0Ftb3VudDIpO1xuXG4gICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoQmlsbGluZ0Ftb3VudDIpLmNhbGwodGhpcywgcHJvcHMpKTtcbiAgICBfdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGxvYWRpbmc6IHRydWUsXG4gICAgICBiaWxsRmllbGRMb2FkaW5nTWVzc2FnZTogJ0xvYWRpbmcuLi4nLFxuICAgICAgYmlsbEFtb3VudDogMTAwXG4gICAgfTtcblxuICAgIHZhciB0aGF0ID0gX2Fzc2VydFRoaXNJbml0aWFsaXplZChfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSk7XG5cbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoYXQuc2V0U3RhdGUoe1xuICAgICAgICBiaWxsQW1vdW50OiA4MDAsXG4gICAgICAgIGxvYWRpbmc6IGZhbHNlXG4gICAgICB9KTtcbiAgICAgIHRoYXQuc2V0U3RhdGUoe1xuICAgICAgICBiaWxsRmllbGRMb2FkaW5nTWVzc2FnZTogdGhhdC5zdGF0ZS5iaWxsQW1vdW50XG4gICAgICB9KTtcbiAgICB9LCAyMjAwKTtcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoQmlsbGluZ0Ftb3VudDIsIFt7XG4gICAga2V5OiBcInJlbmRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7XG4gICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7XG4gICAgICAgICAgcmV0dXJuIF90aGlzMi5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBiaWxsQW1vdW50OiAzMDBcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSwgdGhpcy5zdGF0ZS5iaWxsRmllbGRMb2FkaW5nTWVzc2FnZSk7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIEJpbGxpbmdBbW91bnQyO1xufShSZWFjdC5Db21wb25lbnQpO1xuXG52YXIgQmlsbGluZ0hlYWRlciA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX1JlYWN0JENvbXBvbmVudDIpIHtcbiAgX2luaGVyaXRzKEJpbGxpbmdIZWFkZXIsIF9SZWFjdCRDb21wb25lbnQyKTtcblxuICBmdW5jdGlvbiBCaWxsaW5nSGVhZGVyKCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCaWxsaW5nSGVhZGVyKTtcblxuICAgIHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoQmlsbGluZ0hlYWRlcikuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoQmlsbGluZ0hlYWRlciwgW3tcbiAgICBrZXk6IFwicmVuZGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgIHJldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KCdoMycsIHt9LCAnQ3VycmVudCBNb250aCBCaWxsaW5nIFN1bW1hcnknKTtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gQmlsbGluZ0hlYWRlcjtcbn0oUmVhY3QuQ29tcG9uZW50KTsgLy8gbGV0IGJpbGxpbmdIZWFkZXIgPSA8aDM+Q3VycmVudCBNb250aCBCaWxsaW5nIFN1bW1hcnk8L2gzPjtcbi8vXG4vLyBSZWFjdERPTS5yZW5kZXIoYmlsbGluZ0hlYWRlcixcbi8vICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYmlsbF9oZWFkZXJfY29udGFpbmVyJyksXG4vLyAgICAgJ0N1cnJlbnQgTW9udGggQmlsbGluZyBTdW1tYXJ5Jyk7XG5cblxuUmVhY3RET00ucmVuZGVyKFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2gzJywge30sICdDdXJyZW50IE1vbnRoIEJpbGxpbmcgU3VtbWFyeScpLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYmlsbF9oZWFkZXJfY29udGFpbmVyJykpOyIsIid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiKSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfTsgfSBlbHNlIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfVxuXG5mdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpKSB7IHJldHVybiBjYWxsOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9XG5cbmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gc2VsZjsgfVxuXG5mdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvblwiKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9XG5cbmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9XG5cbnZhciBCaWxsaW5nV2lkZ2V0ID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uIChfUmVhY3QkQ29tcG9uZW50KSB7XG4gIF9pbmhlcml0cyhCaWxsaW5nV2lkZ2V0LCBfUmVhY3QkQ29tcG9uZW50KTtcblxuICBmdW5jdGlvbiBCaWxsaW5nV2lkZ2V0KHByb3BzKSB7XG4gICAgdmFyIF90aGlzO1xuXG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEJpbGxpbmdXaWRnZXQpO1xuXG4gICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoQmlsbGluZ1dpZGdldCkuY2FsbCh0aGlzLCBwcm9wcykpO1xuICAgIF90aGlzLnN0YXRlID0ge1xuICAgICAgYmlsbGVkOiBmYWxzZVxuICAgIH07XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKEJpbGxpbmdXaWRnZXQsIFt7XG4gICAga2V5OiBcInJlbmRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgaWYgKHRoaXMuc3RhdGUuYmlsbGVkKSB7XG4gICAgICAgIHJldHVybiAnWW91IGJpbGxlZCB0aGlzLic7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KCdidXR0b24nLCB7XG4gICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7XG4gICAgICAgICAgcmV0dXJuIF90aGlzMi5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBiaWxsZWQ6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSwgJ0JpbGwnKTtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gQmlsbGluZ1dpZGdldDtcbn0oUmVhY3QuQ29tcG9uZW50KTtcblxudmFyIGJpbGxpbmdEb21Db250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYmlsbF9idXR0b25fY29udGFpbmVyJyk7XG5SZWFjdERPTS5yZW5kZXIoUmVhY3QuY3JlYXRlRWxlbWVudChCaWxsaW5nV2lkZ2V0KSwgYmlsbGluZ0RvbUNvbnRhaW5lcik7IiwiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBfdHlwZW9mKG9iaikgeyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2Yob2JqKTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikpIHsgcmV0dXJuIGNhbGw7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH1cblxuZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb25cIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfVxuXG5mdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfVxuXG5mdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIHNlbGY7IH1cblxudmFyIEZlZXNQYWlkID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uIChfUmVhY3QkQ29tcG9uZW50KSB7XG4gIF9pbmhlcml0cyhGZWVzUGFpZCwgX1JlYWN0JENvbXBvbmVudCk7XG5cbiAgZnVuY3Rpb24gRmVlc1BhaWQocHJvcHMpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRmVlc1BhaWQpO1xuXG4gICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoRmVlc1BhaWQpLmNhbGwodGhpcywgcHJvcHMpKTtcbiAgICBfdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGxvYWRpbmc6IHRydWUsXG4gICAgICBiaWxsRmllbGRMb2FkaW5nTWVzc2FnZTogJ0xvYWRpbmcuLi4nLFxuICAgICAgZmVlc1BhaWQ6IDBcbiAgICB9O1xuXG4gICAgdmFyIHRoYXQgPSBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpKTtcblxuICAgIGZ1bmN0aW9uIGdldEZlZXNQYWlkKCkge1xuICAgICAgJC5nZXQoJ2ZlZXMtcGFpZC5qc29uJykudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB0aGF0LnNldFN0YXRlKHtcbiAgICAgICAgICBmZWVzUGFpZDogZGF0YS5mZWVzUGFpZCxcbiAgICAgICAgICBsb2FkaW5nOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGdldEZlZXNQYWlkKCk7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICB0aGF0LnNldFN0YXRlKHtcbiAgICAgICAgYmlsbEZpZWxkTG9hZGluZ01lc3NhZ2U6IHRoYXQuc3RhdGUuZmVlc1BhaWRcbiAgICAgIH0pO1xuICAgIH0sIDI1MDApO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIF9jcmVhdGVDbGFzcyhGZWVzUGFpZCwgW3tcbiAgICBrZXk6IFwicmVuZGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudCgnc3BhbicsIHtcbiAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHtcbiAgICAgICAgICByZXR1cm4gX3RoaXMyLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGJpbGxBbW91bnQ6IDMwMFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9LCB0aGlzLnN0YXRlLmJpbGxGaWVsZExvYWRpbmdNZXNzYWdlKTtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gRmVlc1BhaWQ7XG59KFJlYWN0LkNvbXBvbmVudCk7Il19
